name: run-tests

on: [push, workflow_dispatch]

jobs:
  build:

    runs-on: ubuntu-latest
    defaults:
      run:
        shell: bash -l {0}

    strategy:
      matrix:
        python-version: [3.6]

    steps:
    - uses: actions/checkout@v2
    - uses: conda-incubator/setup-miniconda@v2
      name: Prepare env
      with:
        activate-environment: testing-env
        architecture: x64
        miniconda-version: "latest"
        python-version: ${{ matrix.python-version }}
        channels: "conda-forge"
        allow-softlinks: true
        channel-priority: "flexible"
        show-channel-urls: true

    - name: Install dependencies
      run: |
        conda activate testing-env
        conda install -y python=3.6 setuptools pytest pyqt=5.9.*
        python -m pip install pytest-qt

    - name: Run tests
      run: |
        conda activate testing-env
        python -m pytest guitest.py
